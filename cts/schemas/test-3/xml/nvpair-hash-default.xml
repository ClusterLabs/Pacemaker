<cib crm_feature_set="3.19.7" validate-with="pacemaker-4.0" epoch="8" num_updates="0" admin_epoch="0">
  <configuration>
    <!-- The essential elements of this test are:
         * For each nvset type (cluster_property_set, instance_attributes,
           meta_attributes, utilization), there are eight elements.
           * Sets 2, 5, and 6 have value "#default" for option1.
           * Sets 1, 5, and 8 have value "#default" for option2.
           * The other positions have "valueX" values, where X is the
             set number.
         * Most nvset elements have a rule. There are a couple of exceptions,
           for testing what happens in the absence of rules.
           * rsc1-meta_attributes4 (values are "value4")
           * rsc1-utilization2 (values are "#default" for option1 and "value2"
             for option2)
           * rsc1-utilization8 (values are "value8" for option1 and "#default"
             for option2)
         * cluster_property_set and instance_attributes elements define new
           rules, while meta_attributes and utilization elements reference
           existing rules.

         In this situation (this will be difficult to read, but the actual
         output should make it clearer):
         * All nvpairs with value "#default" should be dropped.
         * If an nvpair cannot be unset by an nvpair with value "#default" in a
           later nvset (because there is no such "#default" nvpair), then it
           should remain unchanged in its original nvset. This applies to the
           following:
           * cluster-properties{7,8}-option1
           * rsc1-instance_attributes{7,8}-option1
           * rsc1-meta_attributes{7,8}-option1
           * rsc1-utilization{7,8}-option1

         * If an nvpair will always be unset by an nvpair with value "#default"
           in a later nvset (because the latter nvpair's nvset has no rule),
           then it should be dropped. This applies to the following:
           * rsc1-utilization1-option1
           * rsc1-utilization{2,3,4,6,7}-option2

         * If a non-"#default" nvpair has no rule and may be unset by an nvpair
           with value "#default" in a later nvset, it should be dropped from its
           original nvset. It should be moved to a new nvset with:
           * the same score
           * a new "and" rule containing negations of the rules from the later
             nvsets that may unset this nvpair

           This applies to the following:
           * rsc1-meta_attributes4-option{1,2}

         * If a non-"#default" nvpair has a rule and may be unset by an nvpair
           with value "#default" in a later nvset, it should be dropped from its
           original nvset. It should be moved to a new nvset with:
           * the same score
           * a new "and" rule containing:
             * a reference to the rule from this nvpair's original nvset
             * negations of the rules from the later nvsets that may unset this
               nvpair
           This applies to all remaining non-"#default" nvpairs.

         * No rule definitions should be deleted.
      -->
    <crm_config>
      <cluster_property_set id="cluster-properties1" score="7">
        <rule id="cluster-properties1-rule">
          <date_expression id="cluster-properties1-rule-expr" operation="in_range" start="2004-001"/>
        </rule>
        <nvpair id="cluster-properties1-option1" name="option1" value="value1"/>
        <nvpair id="cluster-properties1-option2" name="option2" value="#default"/>
      </cluster_property_set>
      <cluster_property_set id="cluster-properties2" score="6">
        <rule id="cluster-properties2-rule">
          <date_expression id="cluster-properties2-rule-expr" operation="in_range" start="2004-001"/>
        </rule>
        <nvpair id="cluster-properties2-option1" name="option1" value="#default"/>
        <nvpair id="cluster-properties2-option2" name="option2" value="value2"/>
      </cluster_property_set>
      <cluster_property_set id="cluster-properties3" score="5">
        <rule id="cluster-properties3-rule">
          <date_expression id="cluster-properties3-rule-expr" operation="in_range" start="2004-001"/>
        </rule>
        <nvpair id="cluster-properties3-option1" name="option1" value="value3"/>
        <nvpair id="cluster-properties3-option2" name="option2" value="value3"/>
      </cluster_property_set>
      <cluster_property_set id="cluster-properties4">
        <rule id="cluster-properties4-rule">
          <date_expression id="cluster-properties4-rule-expr" operation="in_range" start="2004-001"/>
        </rule>
        <nvpair id="cluster-properties4-option1" name="option1" value="value4"/>
        <nvpair id="cluster-properties4-option2" name="option2" value="value4"/>
      </cluster_property_set>
      <cluster_property_set id="cluster-properties5" score="-1">
        <rule id="cluster-properties5-rule">
          <date_expression id="cluster-properties5-rule-expr" operation="in_range" start="2004-001"/>
        </rule>
        <nvpair id="cluster-properties5-option1" name="option1" value="#default"/>
        <nvpair id="cluster-properties5-option2" name="option2" value="#default"/>
      </cluster_property_set>
      <cluster_property_set id="cluster-properties6" score="-2">
        <rule id="cluster-properties6-rule">
          <date_expression id="cluster-properties6-rule-expr" operation="in_range" start="2004-001"/>
        </rule>
        <nvpair id="cluster-properties6-option1" name="option1" value="#default"/>
        <nvpair id="cluster-properties6-option2" name="option2" value="value6"/>
      </cluster_property_set>
      <cluster_property_set id="cluster-properties7" score="-3">
        <rule id="cluster-properties7-rule">
          <date_expression id="cluster-properties7-rule-expr" operation="in_range" start="2004-001"/>
        </rule>
        <nvpair id="cluster-properties7-option1" name="option1" value="value7"/>
        <nvpair id="cluster-properties7-option2" name="option2" value="value7"/>
      </cluster_property_set>
      <cluster_property_set id="cluster-properties8" score="-4">
        <rule id="cluster-properties8-rule">
          <date_expression id="cluster-properties8-rule-expr" operation="in_range" start="2004-001"/>
        </rule>
        <nvpair id="cluster-properties8-option1" name="option1" value="value8"/>
        <nvpair id="cluster-properties8-option2" name="option2" value="#default"/>
      </cluster_property_set>
    </crm_config>
    <nodes/>
    <resources>
      <primitive class="ocf" id="rsc1" provider="heartbeat" type="apache">
        <instance_attributes id="rsc1-instance_attributes1" score="1000">
          <rule id="rsc1-instance_attributes1-rule">
            <date_expression id="rsc1-instance_attributes1-rule-expr" operation="in_range" start="2004-001"/>
          </rule>
          <nvpair id="rsc1-instance_attributes1-option1" name="option1" value="value1"/>
          <nvpair id="rsc1-instance_attributes1-option2" name="option2" value="#default"/>
        </instance_attributes>
        <instance_attributes id="rsc1-instance_attributes2" score="999">
          <rule id="rsc1-instance_attributes2-rule">
            <date_expression id="rsc1-instance_attributes2-rule-expr" operation="in_range" start="2004-001"/>
          </rule>
          <nvpair id="rsc1-instance_attributes2-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-instance_attributes2-option2" name="option2" value="value2"/>
        </instance_attributes>
        <instance_attributes id="rsc1-instance_attributes3" score="998">
          <rule id="rsc1-instance_attributes3-rule">
            <date_expression id="rsc1-instance_attributes3-rule-expr" operation="in_range" start="2004-001"/>
          </rule>
          <nvpair id="rsc1-instance_attributes3-option1" name="option1" value="value3"/>
          <nvpair id="rsc1-instance_attributes3-option2" name="option2" value="value3"/>
        </instance_attributes>
        <instance_attributes id="rsc1-instance_attributes4" score="997">
          <rule id="rsc1-instance_attributes4-rule">
            <date_expression id="rsc1-instance_attributes4-rule-expr" operation="in_range" start="2004-001"/>
          </rule>
          <nvpair id="rsc1-instance_attributes4-option1" name="option1" value="value4"/>
          <nvpair id="rsc1-instance_attributes4-option2" name="option2" value="value4"/>
        </instance_attributes>
        <instance_attributes id="rsc1-instance_attributes5" score="996">
          <rule id="rsc1-instance_attributes5-rule">
            <date_expression id="rsc1-instance_attributes5-rule-expr" operation="in_range" start="2004-001"/>
          </rule>
          <nvpair id="rsc1-instance_attributes5-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-instance_attributes5-option2" name="option2" value="#default"/>
        </instance_attributes>
        <instance_attributes id="rsc1-instance_attributes6" score="995">
          <rule id="rsc1-instance_attributes6-rule">
            <date_expression id="rsc1-instance_attributes6-rule-expr" operation="in_range" start="2004-001"/>
          </rule>
          <nvpair id="rsc1-instance_attributes6-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-instance_attributes6-option2" name="option2" value="value6"/>
        </instance_attributes>
        <instance_attributes id="rsc1-instance_attributes7" score="994">
          <rule id="rsc1-instance_attributes7-rule">
            <date_expression id="rsc1-instance_attributes7-rule-expr" operation="in_range" start="2004-001"/>
          </rule>
          <nvpair id="rsc1-instance_attributes7-option1" name="option1" value="value7"/>
          <nvpair id="rsc1-instance_attributes7-option2" name="option2" value="value7"/>
        </instance_attributes>
        <instance_attributes id="rsc1-instance_attributes8" score="993">
          <rule id="rsc1-instance_attributes8-rule">
            <date_expression id="rsc1-instance_attributes8-rule-expr" operation="in_range" start="2004-001"/>
          </rule>
          <nvpair id="rsc1-instance_attributes8-option1" name="option1" value="value8"/>
          <nvpair id="rsc1-instance_attributes8-option2" name="option2" value="#default"/>
        </instance_attributes>
        <meta_attributes id="rsc1-meta_attributes1" score="500">
          <rule id-ref="rsc1-instance_attributes1-rule"/>
          <nvpair id="rsc1-meta_attributes1-option1" name="option1" value="value1"/>
          <nvpair id="rsc1-meta_attributes1-option2" name="option2" value="#default"/>
        </meta_attributes>
        <meta_attributes id="rsc1-meta_attributes2" score="499">
          <rule id-ref="rsc1-instance_attributes2-rule"/>
          <nvpair id="rsc1-meta_attributes2-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-meta_attributes2-option2" name="option2" value="value2"/>
        </meta_attributes>
        <meta_attributes id="rsc1-meta_attributes3" score="498">
          <rule id-ref="rsc1-instance_attributes3-rule"/>
          <nvpair id="rsc1-meta_attributes3-option1" name="option1" value="value3"/>
          <nvpair id="rsc1-meta_attributes3-option2" name="option2" value="value3"/>
        </meta_attributes>
        <meta_attributes id="rsc1-meta_attributes4" score="497">
          <nvpair id="rsc1-meta_attributes4-option1" name="option1" value="value4"/>
          <nvpair id="rsc1-meta_attributes4-option2" name="option2" value="value4"/>
        </meta_attributes>
        <meta_attributes id="rsc1-meta_attributes5" score="496">
          <rule id-ref="rsc1-instance_attributes5-rule"/>
          <nvpair id="rsc1-meta_attributes5-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-meta_attributes5-option2" name="option2" value="#default"/>
        </meta_attributes>
        <meta_attributes id="rsc1-meta_attributes6" score="495">
          <rule id-ref="rsc1-instance_attributes6-rule"/>
          <nvpair id="rsc1-meta_attributes6-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-meta_attributes6-option2" name="option2" value="value6"/>
        </meta_attributes>
        <meta_attributes id="rsc1-meta_attributes7" score="494">
          <rule id-ref="rsc1-instance_attributes7-rule"/>
          <nvpair id="rsc1-meta_attributes7-option1" name="option1" value="value7"/>
          <nvpair id="rsc1-meta_attributes7-option2" name="option2" value="value7"/>
        </meta_attributes>
        <meta_attributes id="rsc1-meta_attributes8" score="493">
          <rule id-ref="rsc1-instance_attributes8-rule"/>
          <nvpair id="rsc1-meta_attributes8-option1" name="option1" value="value8"/>
          <nvpair id="rsc1-meta_attributes8-option2" name="option2" value="#default"/>
        </meta_attributes>
        <utilization id="rsc1-utilization1" score="7">
          <rule id-ref="rsc1-instance_attributes1-rule"/>
          <nvpair id="rsc1-utilization1-option1" name="option1" value="value1"/>
          <nvpair id="rsc1-utilization1-option2" name="option2" value="#default"/>
        </utilization>
        <utilization id="rsc1-utilization2" score="6">
          <nvpair id="rsc1-utilization2-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-utilization2-option2" name="option2" value="value2"/>
        </utilization>
        <utilization id="rsc1-utilization3" score="5">
          <rule id-ref="rsc1-instance_attributes3-rule"/>
          <nvpair id="rsc1-utilization3-option1" name="option1" value="value3"/>
          <nvpair id="rsc1-utilization3-option2" name="option2" value="value3"/>
        </utilization>
        <utilization id="rsc1-utilization4">
          <rule id-ref="rsc1-instance_attributes4-rule"/>
          <nvpair id="rsc1-utilization4-option1" name="option1" value="value4"/>
          <nvpair id="rsc1-utilization4-option2" name="option2" value="value4"/>
        </utilization>
        <utilization id="rsc1-utilization5" score="-1">
          <rule id-ref="rsc1-instance_attributes5-rule"/>
          <nvpair id="rsc1-utilization5-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-utilization5-option2" name="option2" value="#default"/>
        </utilization>
        <utilization id="rsc1-utilization6" score="-2">
          <rule id-ref="rsc1-instance_attributes6-rule"/>
          <nvpair id="rsc1-utilization6-option1" name="option1" value="#default"/>
          <nvpair id="rsc1-utilization6-option2" name="option2" value="value6"/>
        </utilization>
        <utilization id="rsc1-utilization7" score="-3">
          <rule id-ref="rsc1-instance_attributes7-rule"/>
          <nvpair id="rsc1-utilization7-option1" name="option1" value="value7"/>
          <nvpair id="rsc1-utilization7-option2" name="option2" value="value7"/>
        </utilization>
        <utilization id="rsc1-utilization8" score="-4">
          <nvpair id="rsc1-utilization8-option1" name="option1" value="value8"/>
          <nvpair id="rsc1-utilization8-option2" name="option2" value="#default"/>
        </utilization>
      </primitive>
    </resources>
    <constraints/>
  </configuration>
  <status/>
</cib>
